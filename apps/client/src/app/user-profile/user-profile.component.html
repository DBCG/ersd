<div>
  <main role="main" class="container vw-75 pb-5">
    <div class="card bg-primary border-0">
      <div class="card-body p-0">
        <h4 class="card-title fw-bold p-4 mb-0 p-4">Profile</h4>

        <div class="px-4 mb-4">

          <div class="row px-3" style="min-height: 500px;">
            <!-- Vertical Tab Navigation -->
            <div class="col-md-3 sidebar-primary p-3 rounded shadow-sm">
              <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                <a class="nav-link active" id="v-pills-tab1" data-bs-toggle="pill" href="#tab1" role="tab"
                  aria-controls="tab1" aria-selected="true">
                  <div class="row align-items-center">
                    <div class="col-auto pe-0"><span><i class="fas fa-user"></i></span></div>
                    <div class="col">
                      User
                    </div>
                  </div>
                </a>
                <!--                 
                <a class="nav-link active" id="v-pills-tab1" data-bs-toggle="pill" href="#tab1" role="tab"
                  aria-controls="tab1" aria-selected="true">User</a> -->

                <a class="nav-link" id="v-pills-tab2" data-bs-toggle="pill" href="#tab2" role="tab" aria-controls="tab2"
                  aria-selected="true">
                  <div class="row align-items-center">
                    <div class="col-auto pe-0"><span><i class="fas fa-bell"></i></span></div>
                    <div class="col">
                      Notifications
                    </div>
                  </div>
                </a>

                <!-- <a class="nav-link" id="v-pills-tab2" data-bs-toggle="pill" href="#tab2" role="tab" aria-controls="tab2"
                  aria-selected="false">Subscriptions</a> -->
              </div>
            </div>

            <!-- Tab Content -->
            <div class="col-md-9 px-4">
              <div class="tab-content" id="v-pills-tabContent">
                <!-- User -->
                <div class="tab-pane fade show active" id="tab1" role="tabpanel" aria-labelledby="v-pills-tab1">
                  <div class="bg-primary-heading mb-3 rounded shadow-sm">
                    <h5 class="mb-0 px-4 fw-medium py-2">User</h5>
                  </div>

                  <div class="alert alert-primary border-0 shadow-sm" role="alert">
                    <div class="row">
                      <div class="col-auto pe-0"><span><i class="fas fa-info-circle"></i></span></div>
                      <div class="col">
                        <p class="m-0">
                          Please provide your primary contact information in the form below. You can choose to create an
                          organizational or individual account. This contact information will be used for general
                          communications related to eRSD. Additionally, you may choose to add secondary contact
                          information as needed.
                        </p>
                      </div>
                    </div>
                  </div>

                  <ersd-edit-person [person]="person" *ngIf="person"></ersd-edit-person>
                  <!-- 
                  <p>
                    <button type="button" class="btn btn-light" (click)="saveContact()">Save</button>
                    <button type="button" class="btn btn-danger" (click)="delete()">Delete</button>
                  </p> -->

                  <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-5">
                    <button id="saveContactBtn" type="button" class="btn btn-secondary" style="width: 150px"
                      (click)="saveContact()">
                      <span>
                        <i class="fas fa-save me-1"></i>
                        <span>Save</span>
                      </span>
                    </button>
                    <button id="cancelBtn" type="button" class="btn btn-tertiary" style="width: 150px" (click)="delete()">
                      <span>
                        <i class="fas fa-user-times me-1"></i>
                        <span>Delete</span>
                      </span>
                    </button>
                  </div>




                </div>
                <!-- Notifications -->
                <div class="tab-pane fade" id="tab2" role="tabpanel" aria-labelledby="v-pills-tab2">
                  <div class="bg-primary-heading mb-3 rounded shadow-sm">
                    <h5 class="mb-0 px-4 fw-medium py-2">Notifications</h5>
                  </div>

                  <div class="alert alert-primary border-0 shadow-sm" role="alert">
                    <div class="row">
                      <div class="col-auto pe-0"><span><i class="fas fa-info-circle"></i></span></div>
                      <div class="col">
                        <p class="m-0">
                          This contact information will be used for general communications related to eRSD.
                        </p>
                      </div>
                    </div>
                  </div>

                  <div>
                    <div *ngIf="person">
                    <div class="fw-bold">Contact Email(s)</div>
                    <label for="emailPrimary" class="form-label">Primary Email</label>
                    <div class="input-group mb-3">
                      <input type="email" [(ngModel)]="person.email" class="form-control" id="emailPrimary" readonly>
                      <span class="input-group-text">
                        <i class="fas fa-lock"></i>
                      </span>
                    </div>
                  </div>
                    <div *ngIf="secondary">
                      <label for="emailSecondary" class="form-label">Secondary Email</label>
                      <div class="input-group mb-3">
                        <input type="email" [(ngModel)]="secondary.email" class="form-control" id="emailSecondary"
                          readonly>
                        <span class="input-group-text">
                          <i class="fas fa-lock"></i>
                        </span>
                      </div>
                    </div>

                    <div class="alert alert-primary border-0 shadow-sm" role="alert">
                      <div class="row">
                        <div class="col-auto pe-0"><span><i class="fas fa-info-circle"></i></span></div>
                        <div class="col">
                          <p class="m-0">
                            Please choose your eRSD notification subscription(s) below. Email subscription is
                            required, and you may add an additional SMS subscription as well. You will be contacted
                            based on your preferences with any important information related to eRSD, or with
                            routine or emergent updates.
                          </p>
                        </div>
                      </div>
                    </div>


                    <div class="fw-bold">eRSD Subscription</div>
                    <div *ngIf="userSubscriptions.emailSubscription">

                      <div class="mb-3">
                        <label for="emailSubscriptionEmail" class="form-label">Subscription Email</label>
                        <input id="emailSubscriptionEmail" type="text" class="form-control"
                          placeholder="joe@somewhere.com" [(ngModel)]="userSubscriptions.emailSubscription.emailAddress"
                          [class.is-invalid]="emailAddress.errors?.email || emailAddress.errors?.required" email="true"
                          required="required" #emailAddress="ngModel" />

                      </div>
                    </div>

                    <!-- <div>
                          <input type="checkbox" [ngModel]="!!userSubscriptions.smsSubscription"
                          (ngModelChange)="toggleSms($event)" class="btn-check" id="btn-check" autocomplete="off">
                          <label class="btn btn-primary btn-dashed" for="btn-check">Add SMS Subscription</label>
                        </div> -->

                    <div class="">
                      <div class="form-check form-switch mb-3">
                        <input class="form-check-input" type="checkbox" (ngModelChange)="toggleSms($event)"
                          [ngModel]="!!userSubscriptions.smsSubscription" role="switch" id="flexSwitchCheckDefault">
                        <label class="form-check-label" for="flexSwitchCheckDefault">Enable SMS Subscription</label>
                      </div>
                    </div>
                    <!-- <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                          <button id="downloadCSVBtn" type="button" class="btn btn-secondary" (click)="getEmailCSV()"
                            [disabled]="isDisabled">
                            Download CSV
                          </button>

                        </div> -->

                    <div *ngIf="userSubscriptions.smsSubscription">

                      <div class="form-group mb-3">
                        <label for="smsSubscriptionCarrier" class="form-label">Carrier</label>
                        <select id="smsSubscriptionCarrier" class="form-select"
                          [(ngModel)]="userSubscriptions.smsSubscription.carrier"
                          [class.is-invalid]="carrier.errors?.required" required="required" #carrier="ngModel">
                          <option [ngValue]="undefined">SELECT</option>
                          <option value="verizon">Verizon</option>
                          <option value="at&t">AT&T</option>
                          <option value="sprint">Sprint</option>
                          <option value="tmobile">T-Mobile</option>
                        </select>


                      </div>

                      <div class="form-group mb-3">
                        <label for="smsSubscriptionMobile" class="form-label">Mobile Phone</label>
                        <input id="smsSubscriptionMobile" type="text" class="form-control" placeholder="(XXX) XXX-XXXX"
                          [(ngModel)]="userSubscriptions.smsSubscription.mobilePhone"
                          [class.is-invalid]="mobileSubscription.errors?.required || mobileSubscription.errors?.pattern"
                          pattern="^(((\d{3}-)|(\(\d{3}\)\s))\d{3}-\d{4})|\d{10}$" required="required"
                          #mobileSubscription="ngModel" />
                        <!-- <div class="help-block">SMS-based subscriptions are email subscriptions sent to addresses
                              that are
                              constructed based on the mobile phone carrier's SMS email address. Each mobile phone
                              carrier supported in
                              this implementation has an email address associated with phone numbers that sends an SMS
                              text message to
                              the destination mobile phone.</div> -->
                      </div>
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-5">
                      <button id="saveBtn" type="button" class="btn btn-secondary" style="width: 150px"
                        (click)="saveSubscription()">
                        <span>
                          <i class="fas fa-save me-1"></i>
                          <span>Save</span>
                        </span>
                      </button>
                    </div>


                  </div>


                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>



<div class='subscription-container d-none'>
  <div class='heading-container'>
    <h2 class='section-heading'>Notification Management</h2>
  </div>

  <div class='page-info subscription-info'>
    <p>Please choose your eRSD notification subscription(s) below. Email subscription is required, and you may add an
      additional SMS subscription as well. You will be contacted based on your preferences with any important
      information related to eRSD, or with routine or emergent updates.</p>
  </div>

  <!-- replace with toast? -->
  <div class="alert" [class.alert-info]="!messageIsError" [class.alert-danger]="messageIsError" *ngIf="message">
    {{message}}</div>

  <div>
    <div>
      <div class="card" *ngIf="userSubscriptions.emailSubscription">
        <div class="card-header">
          Email subscription
        </div>
        <div class="card-body">
          <div class="form-group">
            <label for="emailSubscriptionEmail">Email Address</label>
            <input id="emailSubscriptionEmail" type="text" class="form-control" placeholder="joe@somewhere.com"
              [(ngModel)]="userSubscriptions.emailSubscription.emailAddress"
              [class.is-invalid]="emailAddress.errors?.email || emailAddress.errors?.required" email="true"
              required="required" #emailAddress="ngModel" />
          </div>
        </div>
      </div>
    </div>

    <div>
      <div class="card">
        <div class="card-header">
          <!--suppress HtmlFormInputWithoutLabel -->
          <input type="checkbox" [ngModel]="!!userSubscriptions.smsSubscription" (ngModelChange)="toggleSms($event)" />
          SMS Subscription
        </div>
        <div class="card-body" *ngIf="userSubscriptions.smsSubscription">
          <div class="form-group">
            <label for="smsSubscriptionCarrier">Carrier</label>
            <select id="smsSubscriptionCarrier" class="form-control"
              [(ngModel)]="userSubscriptions.smsSubscription.carrier" [class.is-invalid]="carrier.errors?.required"
              required="required" #carrier="ngModel">
              <option [ngValue]="undefined">SELECT</option>
              <option value="verizon">Verizon</option>
              <option value="at&t">AT&T</option>
              <option value="sprint">Sprint</option>
              <option value="tmobile">T-Mobile</option>
            </select>
          </div>
          <div class="form-group">
            <label for="smsSubscriptionMobile">Mobile Phone</label>
            <input id="smsSubscriptionMobile" type="text" class="form-control" placeholder="(XXX) XXX-XXXX"
              [(ngModel)]="userSubscriptions.smsSubscription.mobilePhone"
              [class.is-invalid]="mobileSubscription.errors?.required || mobileSubscription.errors?.pattern"
              pattern="^(((\d{3}-)|(\(\d{3}\)\s))\d{3}-\d{4})|\d{10}$" required="required"
              #mobileSubscription="ngModel" />
            <div class="help-block">SMS-based subscriptions are email subscriptions sent to addresses that are
              constructed based on the mobile phone carrier's SMS email address. Each mobile phone carrier supported in
              this implementation has an email address associated with phone numbers that sends an SMS text message to
              the destination mobile phone.</div>
          </div>
        </div>
      </div>
    </div>

    <div>
      <button type="button" class="btn btn-primary save-button" [disabled]="!isValid" (click)="saveSubscription()">Save</button>
    </div>
  </div>
</div>